<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u | Jenka Coffee</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/auth.css}">
</head>
<body class="auth-page-container">

<div class="auth-card">
    <div class="auth-card-header">
        <h2>ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u</h2>
        <p>Nh·∫≠p m·∫≠t kh·∫©u m·ªõi c·ªßa b·∫°n</p>
    </div>
    
    <div class="auth-card-body">
        <!-- Success/Error Messages -->
        <div th:if="${success}" class="auth-alert auth-alert-success">
            <span th:text="${success}"></span>
        </div>
        
        <div th:if="${error}" class="auth-alert auth-alert-danger">
            <span th:text="${error}"></span>
        </div>
        
        <form th:action="@{/auth/reset-password}" method="post" id="resetForm">
            <input type="hidden" name="token" th:value="${token}">
            
            <div class="auth-form-group">
                <label class="auth-form-label">M·∫≠t kh·∫©u m·ªõi</label>
                <div class="auth-input-group">
                    <input type="password" 
                           class="auth-form-input" 
                           name="newPassword"
                           id="newPassword"
                           placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi"
                           minlength="6"
                           required>
                    <button type="button" onclick="togglePassword('newPassword')">
                        üëÅÔ∏è
                    </button>
                </div>
                <div class="password-strength-bar" id="strengthBar"></div>
                <div class="password-strength-text" id="strengthText">T·ªëi thi·ªÉu 6 k√Ω t·ª±</div>
            </div>
            
            <div class="auth-form-group">
                <label class="auth-form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u</label>
                <div class="auth-input-group">
                    <input type="password" 
                           class="auth-form-input" 
                           name="confirmPassword"
                           id="confirmPassword"
                           placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi"
                           minlength="6"
                           required>
                    <button type="button" onclick="togglePassword('confirmPassword')">
                        üëÅÔ∏è
                    </button>
                </div>
                <div class="auth-help-text auth-alert-danger" id="matchError" style="display: none;">
                    ‚ö† M·∫≠t kh·∫©u kh√¥ng kh·ªõp!
                </div>
            </div>
            
            <button type="submit" class="auth-btn-primary">
                ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u
            </button>
        </form>
        
        <div class="auth-card-footer">
            <a th:href="@{/auth/login}">‚Üê Quay l·∫°i ƒëƒÉng nh·∫≠p</a>
        </div>
    </div>
</div>

<script>
    function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        input.type = input.type === 'password' ? 'text' : 'password';
    }
    
    // Password strength indicator
    document.getElementById('newPassword').addEventListener('input', function() {
        const password = this.value;
        const strengthBar = document.getElementById('strengthBar');
        const strengthText = document.getElementById('strengthText');
        
        let strength = 0;
        if (password.length >= 6) strength++;
        if (password.length >= 8) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[0-9]/.test(password)) strength++;
        if (/[^A-Za-z0-9]/.test(password)) strength++;
        
        if (strength <= 1) {
            strengthBar.className = 'password-strength-bar weak';
            strengthText.textContent = 'Y·∫øu';
            strengthText.className = 'password-strength-text weak';
        } else if (strength <= 3) {
            strengthBar.className = 'password-strength-bar medium';
            strengthText.textContent = 'Trung b√¨nh';
            strengthText.className = 'password-strength-text medium';
        } else {
            strengthBar.className = 'password-strength-bar strong';
            strengthText.textContent = 'M·∫°nh';
            strengthText.className = 'password-strength-text strong';
        }
    });
    
    // Password match validation
    document.getElementById('confirmPassword').addEventListener('input', function() {
        const newPassword = document.getElementById('newPassword').value;
        const matchError = document.getElementById('matchError');
        
        if (this.value && this.value !== newPassword) {
            matchError.style.display = 'block';
        } else {
            matchError.style.display = 'none';
        }
    });
    
    // Form validation
    document.getElementById('resetForm').addEventListener('submit', function(e) {
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (newPassword !== confirmPassword) {
            e.preventDefault();
            document.getElementById('matchError').style.display = 'block';
        }
    });
</script>
</body>
</html>
